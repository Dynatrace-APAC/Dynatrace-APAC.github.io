
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-styles/default-theme.html">
<link rel="import" href="../paper-styles/typography.html">
<link rel="import" href="../iron-flex-layout/iron-flex-layout.html">
<dom-module id="paper-toolbar">
<template>
<style>
:host{--calculated-paper-toolbar-height:var(--paper-toolbar-height,64px);--calculated-paper-toolbar-sm-height:var(--paper-toolbar-sm-height,56px);-moz-box-sizing:border-box;background:var(--paper-toolbar-background,--primary-color);box-sizing:border-box;color:var(--paper-toolbar-color,--dark-theme-text-color);display:block;height:var(--calculated-paper-toolbar-height);position:relative;@apply(--paper-toolbar)}:host(.animate){transition:var(--paper-toolbar-transition,height .18s ease-in)}:host(.medium-tall){height:calc(var(--calculated-paper-toolbar-height)*2);@apply(--paper-toolbar-medium)}:host(.tall){height:calc(var(--calculated-paper-toolbar-height)*3);@apply(--paper-toolbar-tall)}.toolbar-tools{height:var(--calculated-paper-toolbar-height);padding:0 16px;pointer-events:none;position:relative;@apply(--layout-horizontal);@apply(--layout-center);@apply(--paper-toolbar-content)}@media (max-width:600px){:host{height:var(--calculated-paper-toolbar-sm-height)}:host(.medium-tall){height:calc(var(--calculated-paper-toolbar-sm-height)*2)}:host(.tall){height:calc(var(--calculated-paper-toolbar-sm-height)*3)}.toolbar-tools{height:var(--calculated-paper-toolbar-sm-height)}}#topBar{position:relative}#middleBar{left:0;position:absolute;right:0;top:0}:host(.medium-tall) #middleBar,:host(.tall) #middleBar{-webkit-transform:translateY(100%);transform:translateY(100%)}#bottomBar{bottom:0;left:0;position:absolute;right:0}.toolbar-tools>::content>:not([disabled]){pointer-events:auto}.toolbar-tools>::content .title{@apply(--paper-font-common-base);font-size:20px;font-weight:400;line-height:1;overflow:hidden;pointer-events:none;text-overflow:ellipsis;white-space:nowrap;@apply(--layout-flex)}.toolbar-tools>::content>.title{margin-left:56px}.toolbar-tools>::content>paper-icon-button+.title{margin-left:0}.toolbar-tools>::content .title{@apply(--paper-toolbar-title)}.toolbar-tools>::content paper-icon-button[icon=menu]{margin-right:24px}.toolbar-tools>::content>.fit{bottom:0;left:0;margin:0;position:absolute;right:0;top:auto;width:auto}.start-justified{@apply(--layout-start-justified)}.center-justified{@apply(--layout-center-justified)}.end-justified{@apply(--layout-end-justified)}.around-justified{@apply(--layout-around-justified)}.justified{@apply(--layout-justified)} </style>
<div id="topBar" class$="toolbar-tools [[_computeBarExtraClasses(justify)]]">
<content select=":not(.middle):not(.bottom)"></content>
</div>
<div id="middleBar" class$="toolbar-tools [[_computeBarExtraClasses(middleJustify)]]">
<content select=".middle"></content>
</div>
<div id="bottomBar" class$="toolbar-tools [[_computeBarExtraClasses(bottomJustify)]]">
<content select=".bottom"></content>
</div>
</template>
<script>
Polymer({
      is: 'paper-toolbar',

      hostAttributes: {
        'role': 'toolbar'
      },

      properties: {
        /**
         * Controls how the items are aligned horizontally when they are placed
         * at the bottom.
         * Options are `start`, `center`, `end`, `justified` and `around`.
         */
        bottomJustify: {
          type: String,
          value: ''
        },

        /**
         * Controls how the items are aligned horizontally.
         * Options are `start`, `center`, `end`, `justified` and `around`.
         */
        justify: {
          type: String,
          value: ''
        },

        /**
         * Controls how the items are aligned horizontally when they are placed
         * in the middle.
         * Options are `start`, `center`, `end`, `justified` and `around`.
         */
        middleJustify: {
          type: String,
          value: ''
        }

      },

      attached: function() {
        this._observer = this._observe(this);
        this._updateAriaLabelledBy();
      },

      detached: function() {
        if (this._observer) {
          this._observer.disconnect();
        }
      },

      _observe: function(node) {
        var observer = new MutationObserver(function() {
          this._updateAriaLabelledBy();
        }.bind(this));
        observer.observe(node, {
          childList: true,
          subtree: true
        });
        return observer;
      },

      _updateAriaLabelledBy: function() {
        var labelledBy = [];
        var contents = Polymer.dom(this.root).querySelectorAll('content');
        for (var content, index = 0; content = contents[index]; index++) {
          var nodes = Polymer.dom(content).getDistributedNodes();
          for (var node, jndex = 0; node = nodes[jndex]; jndex++) {
            if (node.classList && node.classList.contains('title')) {
              if (node.id) {
                labelledBy.push(node.id);
              } else {
                var id = 'paper-toolbar-label-' + Math.floor(Math.random() * 10000);
                node.id = id;
                labelledBy.push(id);
              }
            }
          }
        }
        if (labelledBy.length > 0) {
          this.setAttribute('aria-labelledby', labelledBy.join(' '));
        }
      },

      _computeBarExtraClasses: function(barJustify) {
        if (!barJustify) return '';

        return barJustify + (barJustify === 'justified' ? '' : '-justified');
      }
    });
</script>
</dom-module>
